import numpy as np
import matplotlib.pyplot as plt

site_energies = np.array([0., 0., 0., 0., 0., 0., 0., 0.])

bond_energies = np.array([[0., 0., 0., -1., 0., -1., 0., -1.],
                          [0., 0., -1., 0., -1., 0., -1., 0.],
                          [0., -1., 0., 0., 0., -1., 0., -1.],
                          [-1., 0., 0., 0., -1., 0., -1., 0.],
                          [0., -1., 0., -1., 0., 0., 0., -1.],
                          [-1., 0., -1., 0., 0., 0., -1., 0.],
                          [0., -1., 0., -1., 0., -1., 0., 0.],
                          [-1., 0., -1., 0., -1., 0., 0., 0.]])

intercluster_connections = np.array([[0., 0., 3., 3., 3., 3., 3., 3.],
                                     [0., 0., 3., 3., 3., 3., 3., 3.],
                                     [3., 3., 0., 0., 3., 3., 3., 3.],
                                     [3., 3., 0., 0., 3., 3., 3., 3.],
                                     [3., 3., 3., 3., 0., 0., 3., 3.],
                                     [3., 3., 3., 3., 0., 0., 3., 3.],
                                     [3., 3., 3., 3., 3., 3., 0., 0.],
                                     [3., 3., 3., 3., 3., 3., 0., 0.]])/2.

intracluster_connections = np.array([[0., 0., 1., 1., 1., 1., 1., 1.],
                                     [0., 0., 1., 1., 1., 1., 1., 1.],
                                     [1., 1., 0., 0., 1., 1., 1., 1.],
                                     [1., 1., 0., 0., 1., 1., 1., 1.],
                                     [1., 1., 1., 1., 0., 0., 1., 1.],
                                     [1., 1., 1., 1., 0., 0., 1., 1.],
                                     [1., 1., 1., 1., 1., 1., 0., 0.],
                                     [1., 1., 1., 1., 1., 1., 0., 0.]])/2.

AABB = np.array([1., 0., 1., 0., 0., 1., 0., 1.])
AABB = np.array([1., 0., 1., 0., 1., 0., 0., 1.])

print(np.einsum('i, i', site_energies, AABB) +
      np.einsum('ij, ij, i, j',
                bond_energies, intracluster_connections,
                AABB, AABB) +
      np.einsum('ij, ij, i, j',
                bond_energies, intercluster_connections,
                AABB, AABB))
